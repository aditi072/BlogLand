"use strict";(self.webpackChunkmediumclone_angular=self.webpackChunkmediumclone_angular||[]).push([[969],{5969:(Y,m,n)=>{n.r(m),n.d(m,{routes:()=>E});var o=n(6789),l=n(4755),s=n(5030),d=n(9841),f=n(9300),c=n(2782),p=n(2377),h=n(5670),b=n(720);const g={isSubmitting:!1,validationErrors:null},U=(0,o.Tz)({name:"settings",reducer:(0,o.Lq)(g,(0,o.on)(c.Y.updateCurrentUser,e=>({...e,isSubmitting:!0})),(0,o.on)(c.Y.updateCurrentUserSuccess,e=>({...e,isSubmitting:!1})),(0,o.on)(c.Y.updateCurrentUserFailure,(e,a)=>({...e,isSubmitting:!1,validationErrors:a.errors})),(0,o.on)(b.hn,()=>g))}),{name:x,reducer:S,selectValidationErrors:v,selectIsSubmitting:Z}=U;var t=n(2223);function C(e,a){if(1&e&&t._UZ(0,"mc-backend-error-messages",17),2&e){const r=t.oxw(2).ngIf;t.Q6J("backendErrors",r.backendErrors)}}function T(e,a){if(1&e){const r=t.EpF();t.TgZ(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"h1",6),t._uU(5,"Settings"),t.qZA(),t.YNc(6,C,1,1,"mc-backend-error-messages",7),t.TgZ(7,"form",8),t.NdJ("ngSubmit",function(){t.CHM(r);const u=t.oxw(2);return t.KtG(u.submit())}),t.TgZ(8,"fieldset")(9,"fieldset",9),t._UZ(10,"input",10),t.qZA(),t.TgZ(11,"fieldset",9),t._UZ(12,"input",11),t.qZA(),t.TgZ(13,"fieldset",9),t._UZ(14,"textarea",12),t.qZA(),t.TgZ(15,"fieldset",9),t._UZ(16,"input",13),t.qZA(),t.TgZ(17,"fieldset",9),t._UZ(18,"input",14),t.qZA(),t.TgZ(19,"button",15),t._uU(20," Update settings "),t.qZA()()(),t._UZ(21,"hr"),t.TgZ(22,"button",16),t.NdJ("click",function(){t.CHM(r);const u=t.oxw(2);return t.KtG(u.logout())}),t._uU(23," Or click here to logout "),t.qZA()()()()()}if(2&e){const r=t.oxw().ngIf,i=t.oxw();t.xp6(6),t.Q6J("ngIf",r.backendErrors),t.xp6(1),t.Q6J("formGroup",i.form),t.xp6(12),t.Q6J("disabled",i.form.invalid||r.isSubmitting)}}function y(e,a){if(1&e&&(t.ynx(0),t.YNc(1,T,24,3,"div",1),t.BQk()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("ngIf",r.currentUser)}}const E=[{path:"",component:(()=>{class e{constructor(r,i){this.fb=r,this.store=i,this.form=this.fb.nonNullable.group({image:"",username:"",bio:"",email:"",password:""}),this.data$=(0,d.a)({isSubmitting:this.store.select(Z),backendErrors:this.store.select(v)})}ngOnInit(){this.currentUserSubscription=this.store.pipe((0,o.Ys)(p.HF),(0,f.h)(Boolean)).subscribe(r=>{this.currentUser=r,this.initializeForm()})}ngOnDestroy(){this.currentUserSubscription?.unsubscribe()}initializeForm(){if(!this.currentUser)throw new Error("current user is not set");this.form.patchValue({image:this.currentUser.image??"",username:this.currentUser.username,bio:this.currentUser.bio??"",email:this.currentUser.email,password:""})}submit(){if(!this.currentUser)throw new Error("current user is not set");const r={user:{...this.currentUser,...this.form.getRawValue()}};this.store.dispatch(c.Y.updateCurrentUser({currentUserRequest:r}))}logout(){this.store.dispatch(c.Y.logout())}}return e.\u0275fac=function(r){return new(r||e)(t.Y36(s.qu),t.Y36(o.yh))},e.\u0275cmp=t.Xpm({type:e,selectors:[["mc-settings"]],standalone:!0,features:[t.jDz],decls:2,vars:3,consts:[[4,"ngIf"],["class","settings-page",4,"ngIf"],[1,"settings-page"],[1,"container","page"],[1,"row"],[1,"col-md-6","offset-md-3","col-xs-12"],[1,"text-xs-center"],[3,"backendErrors",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"form-group"],["type","text","formControlName","image","placeholder","URL of profile picture",1,"form-control","form-control-lg"],["type","text","formControlName","username","placeholder","Username",1,"form-control","form-control-lg"],["formControlName","bio","placeholder","Short bio about you",1,"form-control","form-control-lg"],["type","text","formControlName","email","placeholder","Email",1,"form-control","form-control-lg"],["type","password","formControlName","password","placeholder","New password",1,"form-control","form-control-lg"],["type","submit",1,"btn","btn-lg","btn-primary","pull-xs-right",3,"disabled"],[1,"btn","btn-outline-danger",3,"click"],[3,"backendErrors"]],template:function(r,i){1&r&&(t.YNc(0,y,2,1,"ng-container",0),t.ALo(1,"async")),2&r&&t.Q6J("ngIf",t.lcZ(1,1,i.data$))},dependencies:[l.ez,l.O5,l.Ov,s.UX,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,h.A],encapsulation:2}),e})(),providers:[(0,o.oY)(x,S)]}]}}]);